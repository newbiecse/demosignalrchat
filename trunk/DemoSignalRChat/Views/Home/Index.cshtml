@{
    ViewBag.Title = "Home Page";
}
@using DemoSignalRChat.ViewModels
@using DemoSignalRChat.Preview
@model UserViewModel

Link:
<h1>Hello world</h1>


@Html.Partial("_PostStatus", new StatusViewModel())

<hr />

<h2>Chat - @Model.UserName <input type="button" value="new chat" id="new-chat" />  <input type="button" value="Turn Off Chat" id="turn-off-chat" /> </h2>
<div class="container">
    <div class="col-md-10">

        <div class="row">
            @*@foreach (Img i in ViewBag.imgSrcs)
            {
                <h2>width: @i.Width - height: @i.Height</h2>
                <img src="@i.Src" />
                <br />
            }*@
        </div>

        <div class="row">
            <input type="text" id="message" />
            <input type="button" id="sendmessage" value="Send" />
            <ul id="discussion"></ul>
        </div>

        <hr />

        <div class="row">
            UserId: <input type="text" id="txt_userId" /><br />

            Message: <input type="text" id="txt_prvmessage" />
            <input type="button" id="send_prvmessage" value="Send private message" />
            <ul id="private_discussion"></ul><!--\#private_discussion-->
        </div>
    </div>
    <div class="col-md-2">
        @Html.Partial("_FriendList", (List<UserViewModel>)ViewBag.FriendList)
    </div>

    <div id="list-chat">
    </div>
</div>

@section scripts {

    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.0.0.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>

    <!-- init global variables -->
    <script>
        var userName = '@Model.UserName';
        var curUserId = '@Model.UserId';
    </script>

    <script src="~/Scripts/myScripts/Chats/server/chathubs.js"></script>

    <script src="~/Scripts/myScripts/Chats/client/onConnected.js"></script>
    <script src="~/Scripts/myScripts/Chats/client/onNewUserConnected.js"></script>

    <script src="~/Scripts/myScripts/Chats/client/offChat.js"></script>
    <script src="~/Scripts/myScripts/Chats/client/signOut.js"></script>
    
    <script src="~/Scripts/myScripts/Chats/openChatBox.js"></script>

    <script src="~/Scripts/myScripts/Chats/client/messageReceived.js"></script>
    <script src="~/Scripts/myScripts/Chats/client/privateMessageReceived.js"></script>

    <script src="~/Scripts/myScripts/Chats/server/sendMessageToAll.js"></script>
    <script src="~/Scripts/myScripts/Chats/server/sendPrivateMessage.js"></script>

    <script src="~/Scripts/myScripts/Chats/server/turnOffChat.js"></script>
    <script src="~/Scripts/myScripts/Chats/server/signOut.js"></script>

    <script src="~/Scripts/myScripts/Chats/replaceURLWithHTMLLinks.js"></script>
    <script src="~/Scripts/myScripts/Chats/replaceEmotion.js"></script>


    <script>
        $(document).ready(function () {

            var request;

            $("#post-status").submit(function () {

                $form = $(this);

                request = $.ajax({
                    url: "/Home/PostLink",
                    type: "POST",
                    data: $form.serialize()
                })
                    .done(function (response, textStatus, jqXHR) {
                        alert("success");
                        console.log(response);
                    })
                    .fail(function (response, textStatus, jqXHR) {
                            alert("error");
                    });

                event.preventDefault();


            });// end submit
        });// end ready

    </script>
}
